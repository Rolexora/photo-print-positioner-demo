<!DOCTYPE html><html lang="hu">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Photo Print Positioner (PPP)</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      max-width: 800px;
      margin: auto;
    }
    input[type="number"] {
      width: 5em;
    }
    canvas {
      border: 1px solid #ccc;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1>Photo Print Positioner (PPP)</h1>
  <p>Tölts fel képeket, adj meg egyéni méreteket (cm-ben), és generálj elrendezést egy kiválasztott papírméretre.</p><label>Papírméret: <select id="paperSize"> <option value="9x13">9x13 cm</option> <option value="10x15">10x15 cm</option> <option value="11x17">11x17 cm</option> <option value="13x18">13x18 cm</option> <option value="A4">A4 (21x29.7 cm)</option> <option value="A3">A3 (29.7x42 cm)</option> </select> </label>

<br /><br /> <input type="file" id="imageUpload" multiple accept="image/*" /> <button onclick="generatePreview()">Előnézet generálása</button> <button onclick="downloadImage()">Letöltés</button>

  <div id="imageInputs"></div>
  <canvas id="previewCanvas"></canvas>  <script>
    const imageInputs = document.getElementById('imageInputs');
    const imageUpload = document.getElementById('imageUpload');
    const canvas = document.getElementById('previewCanvas');
    const ctx = canvas.getContext('2d');

    let images = [];
    let imageSettings = [];

    const paperSizes = {
      '9x13': [9, 13],
      '10x15': [10, 15],
      '11x17': [11, 17],
      '13x18': [13, 18],
      'A4': [21, 29.7],
      'A3': [29.7, 42]
    };

    imageUpload.addEventListener('change', (e) => {
      images = [];
      imageSettings = [];
      imageInputs.innerHTML = '';

      Array.from(e.target.files).forEach((file, index) => {
        const reader = new FileReader();
        reader.onload = function (event) {
          const img = new Image();
          img.onload = function () {
            images.push(img);
            imageSettings.push({ width: 3, height: 4 }); // alapértelmezett méret

            const div = document.createElement('div');
            div.innerHTML = `Kép ${index + 1} - Szélesség (cm): <input type="number" step="0.1" value="3" onchange="updateSize(${index}, 'width', this.value)" /> Magasság (cm): <input type="number" step="0.1" value="4" onchange="updateSize(${index}, 'height', this.value)" />`;
            imageInputs.appendChild(div);
          };
          img.src = event.target.result;
        };
        reader.readAsDataURL(file);
      });
    });

    function updateSize(index, dim, value) {
      imageSettings[index][dim] = parseFloat(value);
    }

    function generatePreview() {
      const [paperWcm, paperHcm] = paperSizes[document.getElementById('paperSize').value];
      const dpi = 300;
      const paperWpx = (paperWcm / 2.54) * dpi;
      const paperHpx = (paperHcm / 2.54) * dpi;

      canvas.width = paperWpx;
      canvas.height = paperHpx;
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      let x = 0, y = 0, rowHeight = 0;
      images.forEach((img, i) => {
        const wcm = imageSettings[i].width;
        const hcm = imageSettings[i].height;
        const wpx = (wcm / 2.54) * dpi;
        const hpx = (hcm / 2.54) * dpi;

        if (x + wpx > canvas.width) {
          x = 0;
          y += rowHeight;
          rowHeight = 0;
        }

        if (y + hpx <= canvas.height) {
          ctx.drawImage(img, x, y, wpx, hpx);
          x += wpx;
          if (hpx > rowHeight) rowHeight = hpx;
        }
      });
    }

    function downloadImage() {
      const link = document.createElement('a');
      link.download = 'layout.png';
      link.href = canvas.toDataURL();
      link.click();
    }
  </script></body>
</html>
